{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nexport async function getPhotos (userQuery, page) {\n   const searchParams = new URLSearchParams({\n    key:\"45431575-a54d9a4f673da9f6ecaf0fabb\", \n    page ,\n    per_page: 15,\n    q: userQuery, image_type:\"photo\", \n    orientation:\"horizontal\", \n    safesearch: true})\n\n    const {data} = await axios(`https://pixabay.com/api/?${searchParams}`)\n   \n    return data;\n}\n\n\n","\nimport SimpleLightbox from \"simplelightbox\";\n\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport { gallery } from \"../main\";\nconst lightBox = new SimpleLightbox('.gallery a');\n\n\nexport function createMarkup (images) {\n    const markup = images.map(img=>`\n    <li class='gallery-item'><a class=\"gallery-link\"  href=\"${img.largeImageURL}\">\n    <img class=\"gallery-img\" src=\"${img.webformatURL}\" alt=\"${img.tags}\">\n      </a>\n    <ul class=\"card-info\">\n    <li class=\"card-info-item\">\n      <p>Like:${img.likes}</p>\n    </li>\n    <li class=\"card-info-item\">\n      <p>Views:${img.views}</p>\n    </li>\n    <li class=\"card-info-item\">\n      <p>Coments:${img.comments}</p>\n    </li>\n    <li class=\"card-info-item\">\n      <p>Downloads:${img.downloads}</p>\n    </li></ul>\n  </li>`).join(\"\")\n  gallery.insertAdjacentHTML(\"beforeend\", markup)\n  lightBox.refresh()\n}","import iziToast from 'izitoast';\nimport 'modern-normalize/modern-normalize.css';\nimport 'izitoast/dist/css/iziToast.min.css';\n\n\n\nimport { getPhotos } from './js/pixabay-api';\nimport { createMarkup } from './js/render-functions';\n\nconst loader = document.querySelector('.loader');\nconst loadMore = document.querySelector('.load-more');\nconst form = document.querySelector('.search-form');\nexport const gallery = document.querySelector('.gallery');\n\nlet maxPage = 0;\nlet currentPage = 1;\nlet currentQuerry = '';\n\nform.addEventListener('submit', formSubmit);\nasync function formSubmit(evt) {\n  evt.preventDefault();\n\n  gallery.innerHTML = '';\n\n  const { search } = evt.currentTarget.elements;\n  currentQuerry = search.value.trim();\n  currentPage = 1;\n  if (currentQuerry === '') {\n    return iziToast.error({\n      position: 'topRight',\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n    });\n  }\n  loader.classList.remove('isheaden');\ntry {\n  const data = await getPhotos(currentQuerry, currentPage)\n    if (data.hits.length === 0) {\n      loadMore.classList.add('isheaden')\n      return iziToast.warning({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n    }\n    createMarkup(data.hits);\n    smuthScroll();\n    maxPage = Math.ceil(data.totalHits / 15)\n    form.reset();\n  if (data.totalHits > 15) {\n    // const lastElement = gallery.lastElementChild\n    loadMore.classList.remove('isheaden');\n    // obServer.observe(lastElement)\n  }\n  \n} catch (error) {\n  \n    iziToast.error({ position: 'topRight', message: error.message })\n  \n} finally {\n  loader.classList.add('isheaden');\n}\n\n   \n   \n}\n\nloadMore.addEventListener(\"click\", onLoadMore)\n// const obServer = new IntersectionObserver(gard, {threshold:0.3})\n// function gard (entries, obServer) {\n//   entries.forEach(element => {\n//     if (element.isIntersecting) {\n//       obServer.unobserve(element.target)\n//       onLoadMore()\n//     }\n//   });\n// }\n\nasync function onLoadMore () {\n\n  loader.classList.remove('isheaden');\n  currentPage += 1;\ntry {\n  const data = await getPhotos(currentQuerry, currentPage)\n  createMarkup(data.hits);\n  // const lastElement = gallery.lastElementChild\n  // if (lastElement) {\n    \n    // obServer.observe(lastElement)\n  // }\n  smuthScroll ()\n    if (maxPage === currentPage) {\n      loadMore.classList.add('isheaden');\n      // obServer.unobserve(lastElement)\n      return iziToast.warning({\n        message:\n        \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    }\n\n \n  \n} catch (error) {\n  \n    iziToast.error({ position: 'topRight', message: error.message })\n  \n} finally {\n  loader.classList.add('isheaden');\n}\n\n\n}\n\n\n\nfunction smuthScroll () {\nconst  {height} = gallery.firstElementChild.getBoundingClientRect()\nconsole.log(height);\nwindow.scrollBy({\n  top: height * 2,\n  behavior: \"smooth\",\n});\n}\n\n"],"names":["getPhotos","userQuery","page","searchParams","data","axios","lightBox","SimpleLightbox","createMarkup","images","markup","img","gallery","loader","loadMore","form","maxPage","currentPage","currentQuerry","formSubmit","evt","search","iziToast","smuthScroll","error","onLoadMore","height"],"mappings":"wyBAEO,eAAeA,EAAWC,EAAWC,EAAM,CAC/C,MAAMC,EAAe,IAAI,gBAAgB,CACxC,IAAI,qCACJ,KAAAD,EACA,SAAU,GACV,EAAGD,EAAW,WAAW,QACzB,YAAY,aACZ,WAAY,EAAI,CAAC,EAEX,CAAC,KAAAG,CAAI,EAAI,MAAMC,EAAM,4BAA4BF,CAAY,EAAE,EAErE,OAAOC,CACX,CCTA,MAAME,EAAW,IAAIC,EAAe,YAAY,EAGzC,SAASC,EAAcC,EAAQ,CAClC,MAAMC,EAASD,EAAO,IAAIE,GAAK;AAAA,8DAC2BA,EAAI,aAAa;AAAA,oCAC3CA,EAAI,YAAY,UAAUA,EAAI,IAAI;AAAA;AAAA;AAAA;AAAA,gBAItDA,EAAI,KAAK;AAAA;AAAA;AAAA,iBAGRA,EAAI,KAAK;AAAA;AAAA;AAAA,mBAGPA,EAAI,QAAQ;AAAA;AAAA;AAAA,qBAGVA,EAAI,SAAS;AAAA;AAAA,QAE1B,EAAE,KAAK,EAAE,EACfC,EAAQ,mBAAmB,YAAaF,CAAM,EAC9CJ,EAAS,QAAS,CACpB,CCpBA,MAAMO,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAW,SAAS,cAAc,YAAY,EAC9CC,EAAO,SAAS,cAAc,cAAc,EACrCH,EAAU,SAAS,cAAc,UAAU,EAExD,IAAII,EAAU,EACVC,EAAc,EACdC,EAAgB,GAEpBH,EAAK,iBAAiB,SAAUI,CAAU,EAC1C,eAAeA,EAAWC,EAAK,CAC7BA,EAAI,eAAc,EAElBR,EAAQ,UAAY,GAEpB,KAAM,CAAE,OAAAS,CAAQ,EAAGD,EAAI,cAAc,SAGrC,GAFAF,EAAgBG,EAAO,MAAM,OAC7BJ,EAAc,EACVC,IAAkB,GACpB,OAAOI,EAAS,MAAM,CACpB,SAAU,WACV,QACE,0EACR,CAAK,EAEHT,EAAO,UAAU,OAAO,UAAU,EACpC,GAAI,CACF,MAAMT,EAAO,MAAMJ,EAAUkB,EAAeD,CAAW,EACrD,GAAIb,EAAK,KAAK,SAAW,EACvB,OAAAU,EAAS,UAAU,IAAI,UAAU,EAC1BQ,EAAS,QAAQ,CACtB,QACE,2EACF,SAAU,UAClB,CAAO,EAEHd,EAAaJ,EAAK,IAAI,EACtBmB,IACAP,EAAU,KAAK,KAAKZ,EAAK,UAAY,EAAE,EACvCW,EAAK,MAAK,EACRX,EAAK,UAAY,IAEnBU,EAAS,UAAU,OAAO,UAAU,CAIxC,OAASU,EAAO,CAEZF,EAAS,MAAM,CAAE,SAAU,WAAY,QAASE,EAAM,QAAS,CAEnE,QAAU,CACRX,EAAO,UAAU,IAAI,UAAU,CACjC,CAIA,CAEAC,EAAS,iBAAiB,QAASW,CAAU,EAW7C,eAAeA,GAAc,CAE3BZ,EAAO,UAAU,OAAO,UAAU,EAClCI,GAAe,EACjB,GAAI,CACF,MAAMb,EAAO,MAAMJ,EAAUkB,EAAeD,CAAW,EAQrD,GAPFT,EAAaJ,EAAK,IAAI,EAMtBmB,EAAc,EACRP,IAAYC,EACd,OAAAH,EAAS,UAAU,IAAI,UAAU,EAE1BQ,EAAS,QAAQ,CACtB,QACA,6DACA,SAAU,UAClB,CAAO,CAKP,OAASE,EAAO,CAEZF,EAAS,MAAM,CAAE,SAAU,WAAY,QAASE,EAAM,QAAS,CAEnE,QAAU,CACRX,EAAO,UAAU,IAAI,UAAU,CACjC,CAGA,CAIA,SAASU,GAAe,CACxB,KAAO,CAAC,OAAAG,CAAM,EAAId,EAAQ,kBAAkB,sBAAuB,EACnE,QAAQ,IAAIc,CAAM,EAClB,OAAO,SAAS,CACd,IAAKA,EAAS,EACd,SAAU,QACZ,CAAC,CACD"}